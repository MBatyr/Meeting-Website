@model IEnumerable<Сайт_Знакомств.ViewModels.NotFullUserInfoViewModel>

@{
    ViewData["Title"] = "Search";
}
<h3>@DateTime.Now</h3>

<nav class="navbar navbar-light bg-light justify-content-between">
    <a class="navbar-brand">Найдите свою пару</a>
    <button class="btn btn-success" id="showFilterUrButton">Фильтр</button>
    <form class="form-inline" id="FilterForm">
        <input name="userName" type="hidden" value="@User.Identity.Name" />
        <input name="userName" id="userName" class="form-control mr-sm-2" type="search" placeholder="Поиск по имени" aria-label="Search">
        <input asp-action="UserFilter" class="btn btn-outline-success my-2 my-sm-0" type="submit" value="Поиск" />
    </form>
</nav>
<div class="navbar navbar-light bg-light justify-content-between">
    <form id="FilterUr" style="display:none">
        <h3>Возраст</h3>
        <div class="form-inline">
            <input name="userName" type="hidden" value="@User.Identity.Name" />
            <input name="Age1" id="Age1" class="form-control mr-sm-2" type="number" placeholder="От" required max="100" min="18">
            <input name="Age2" id="Age2" class="form-control mr-sm-2" type="number" placeholder="До" required max="100" min="18">
        </div>

        <br />
        <h3>Пол</h3>
        <div class="form-check">
            <input class="form-check-input" type="radio" name="Sex" value="1" id="Sex">
            <label class="form-check-label" for="flexRadioDefault1">
                Мужчина
            </label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="radio" name="Sex" value="2" id="Sex" checked>
            <label class="form-check-label" for="flexRadioDefault2">
                Женшина
            </label>
        </div>
        <br /> <input asp-action="UserFilter" asp-controller="Home" class="btn btn-success" type="submit" value="Фильтр" />
    </form>
</div>

<div id="UserList" class="row col" >
    @foreach (var item in Model)
    {
        <div class="col">
            <br />
            @if (item.User1Id != item.User2Id)
            {

                <p><img src="@item.Path" alt="doest work" style="width:200px; height:200px " class="rounded-circle"></p>
                @Html.HiddenFor(modelInfo => item.User1Id)
                @Html.HiddenFor(modelInfo => item.User2Id)

                @Html.DisplayName("Имя: ")
                @Html.DisplayFor(modelItem => item.FirstName) <br />

                @Html.DisplayName("Фамилия: ")
                @Html.DisplayFor(modelItem => item.LastName) <br />

                @Html.DisplayName("Возраст: ")
                @Html.DisplayFor(modelItem => item.Age)
                <div class="col">
                    @Html.ActionLink("Выбирать", "Info", new { user1Id = item.User1Id, user2Id = item.User2Id })
                </div>
            }

        </div>
    }


</div>


@section scripts
{ 
    <script type="text/javascript">
        $(document).ready(function () {  

            function showFilterUsersForm() {
                $("#FilterUr").show();
            }

            function hideFilterUsersForm() {
                $("#FilterUr").hide();
            }

            $("#showFilterUrButton").click(function (e) {
                $("#FilterUr").is(":visible")
                    ? hideFilterUsersForm()
                    : showFilterUsersForm();
            })

            $("FilterUr").submit(function (e) {
                e.preventDefault();
                let Age1 = $("#Age1").val();
                let Age2 = $("#Age2").val();
                let Sex = $("#Sex").val();
                let url = `/Home/UserFilter/?Age1=${Age1}/?Ag2=${Age2}/?Sex=${Sex}`;
                $.ajax({
                    type: "Get",
                    url: url,
                    error: function (result1) {
                        alert("Error has occured");

                    },
                    success: function (result1) {
                        $("#UserList").html(result1)
                    }
                });

            });

            $("#FilterForm").submit(function (e) {
                e.preventDefault();
                let userName = $("#userName").val();
                let url = `/Home/UserFilter/?userName=${userName}`;
                $.ajax({
                    type: "Get",
                    url: url,
                    error: function (result) {
                        alert("Error has occured");
                    },
                    success: function (result) {
                        $("#UserList").html(result);
                    }
                    

                });
            });
        })
    </script>
}


